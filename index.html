<!DOCTYPE html> <html lang="en"> <head> <meta charset="UTF-8" /> <meta name="viewport" content="width=device-width, initial-scale=1.0" /> <title>splitCsv</title> <script src="./jquery-3.6.0.min.js"></script> <script src="./papaparse.min.js"></script> <style> * { padding: 0; margin: 0; font-family: Microsoft YaHei UI; } #content { width: 90%; margin: 0 auto; padding-top: 80px; } h1 { font-size: 30px; color: #333; text-align: center; } #fileUpload { display: none; } .uploadBox { box-sizing: border-box; width: 50%; height: 44px; margin: 60px auto; background-color: rgb(220, 215, 241); border: 1px solid #4e6ef2; border-radius: 8px; font-size: 16px; color: #4e6ef2; text-align: center; line-height: 44px; cursor: pointer; } .btnBox, .resultBox { display: flex; align-items: center; justify-content: space-evenly; width: 100%; margin: 40px auto; } #splitCsv, #replaceText, #clipText, #clipOrder, #clipHwg, #hwgCreatCsv { font-size: 14px; color: #fff; line-height: 36px; text-align: center; padding: 0 20px; background-color: #4e6ef2; border: none; border-radius: 4px; cursor: pointer; } .resultBox div { width: 49%; } #beforeObj, #resultObj { width: 100%; } </style> </head> <body> <div id="content"> <h1>新疆阿布丹食品开发有限公司CSV定制化系统</h1> <div class="uploadBox">点击上传csv文件</div> <input id="fileUpload" type="file" accept=".csv" /> <div class="btnBox"> <button id="splitCsv">拆分回传快递单号（测试版）</button> <button id="replaceText">替换商品名称（测试版）</button> <!-- <button id="clipText">生成新订单号</button> --> <!-- <button id="clipOrder">拆单(爱心北京)</button> --> <button id="clipHwg">拆单-好物购（测试版）</button> <button id="hwgCreatCsv">制单-好物购（测试版）</button> </div> <p style="display: flex;justify-content: center; text-align: left;"> 系统为测试版本，还需经过严格测试，功能失效事件：2025.1.15 20:00:00 <br> ①拆分回传快递单号（测试版）：（表格数据：订单号|快递单号）<br> ②替换商品名称（测试版）：(表格数据:单列) 南粤：SKUID；爱心北京：商品ID；三峡e购：商品编号；央企消费帮扶：商品名称；小南直选：商品名称；粤工惠购：商品名称；茶觉文化-中信：商品名称；<br> <!-- ③生成新订单号:（表格数据：订单号|商品名称）<br> --> ③拆单-好物购（测试版）：物流模板原表格上传,在最后插入新订单号，商品名称，数量，自动下载表格<br> ④制单-好物购（测试版）：将拆单的文件直接上传一键制单 </p> <div class="resultBox"> <div> <p>原始数据：</p> <textarea name="输出结果" id="beforeObj" cols="45" rows="30"></textarea> </div> <div> <p>处理结果：</p> <textarea name="输出结果" id="resultObj" cols="45" rows="30"></textarea> </div> </div> </div> <script> $(document).ready(function () { $(".uploadBox").on("click", function () { $("#fileUpload").click(); $("#fileUpload").on("change", function () { var file = $("#fileUpload").prop("files")[0]; file.name ? $(".uploadBox").text(file.name) : $(".uploadBox").text("点击上传csv文件"); }); }); //拆分csv $("#splitCsv").click(function (e) { var file = $("#fileUpload").prop("files")[0]; Papa.parse(file, { encoding: "gb2312", complete: function (results) { splitCsv(results.data); }, }); }); //替换 $("#replaceText").click(function (e) { var file = $("#fileUpload").prop("files")[0]; Papa.parse(file, { encoding: "gb2312", complete: function (results) { replaceText(results.data); }, }); }); //时间戳 function formatTimestamp(timestamp, format = 'YYYY-MM-DD HH:mm:ss') { const date = new Date(timestamp); const year = date.getFullYear(); const month = String(date.getMonth() + 1).padStart(2, '0'); const day = String(date.getDate()).padStart(2, '0'); const hours = String(date.getHours()).padStart(2, '0'); const minutes = String(date.getMinutes()).padStart(2, '0'); const seconds = String(date.getSeconds()).padStart(2, '0'); return format .replace('YYYY', year) .replace('MM', month) .replace('DD', day) .replace('HH', hours) .replace('mm', minutes) .replace('ss', seconds); } const timestamp = Date.now(); const formattedString = formatTimestamp(timestamp); function downloadCsv(dataArray) { // 将数组转换为 csv 格式的字符串 var csvString = dataArray.map(function(row) { return row.join(","); // 用逗号分隔数组中的每个元素 }).join("\n"); // 用换行符分隔每一行 let filename = $(".uploadBox").text().replaceAll(".csv","")+"-"+formattedString+".csv"; // 创建一个隐藏的 a 标签用于下载 var downloadLink = $("<a></a>") .attr("href", "data:text/csv;charset=utf-8,\uFEFF" + encodeURIComponent(csvString)) // 设置下载链接，\uFEFF 是 BOM 字符，用于 Excel 正确识别 UTF-8 编码 .attr("download", filename) // 设置下载文件名 .appendTo("body"); // 触发点击事件，开始下载 downloadLink[0].click(); // 下载完成后移除 a 标签 downloadLink.remove(); }; //生成新单号 $("#clipText").click(function (e) { var file = $("#fileUpload").prop("files")[0]; Papa.parse(file, { encoding: "gb2312", complete: function (results) { clipText(results.data); }, }); }); //拆单-爱心北京 // $("#clipOrder").click(function (e) { //   var file = $("#fileUpload").prop("files")[0]; //   Papa.parse(file, { //     encoding: "gb2312", //     complete: function (results) { //       clipOrder(results.data); //     }, //   }); // }); //拆单-好物购 $("#clipHwg").click(function (e) { var file = $("#fileUpload").prop("files")[0]; Papa.parse(file, { encoding: "gb2312", complete: function (results) { clipHwg(results.data); }, }); }); //制单-好物购 $("#hwgCreatCsv").click(function (e) { var file = $("#fileUpload").prop("files")[0]; Papa.parse(file, { encoding: "gb2312", complete: function (results) { let newTable =  creatTab(results.data,"hwg"); creatCsvTab(newTable); }, }); }); //拆分csv function splitCsv(data) { // 在这里可以使用data数组进行数据处理或显示 console.log(data); let oldJson = {}; let keyArr = []; let valueArr = []; for (let i = 0; i < data.length; i++) { //csv行数据 let obj = data[i]; oldJson[obj[0]] = obj[1]; //每行数据 let idKey = obj[0].split(","); let numValue = obj[1]; //循环拆分push到不同数组 for (let i = 0; i < idKey.length; i++) { keyArr.push(idKey[i]); valueArr.push(numValue); } }; //输出到原始数据框 let oldStr = JSON.stringify(oldJson) .replaceAll("{", "") .replaceAll("}", "") .replaceAll('"', "") .replaceAll(",", "\n"); $("#beforeObj").val(oldStr); //合并成为新的json对象 let newJson = {}; let newArr =[]; for (let i = 0; i < keyArr.length; i++) { newJson[keyArr[i]] = valueArr[i]; } console.log(newJson) //转换为字符串输出到文本域 let newStr = JSON.stringify(newJson) .replaceAll("{", "") .replaceAll("}", "") .replaceAll('"', "") .replaceAll(",", "\n"); $("#resultObj").val(newStr); } let defaultConfig = { //南粤 key：skuid "50563293": "阿布丹 核桃玛仁原味 228g", "50563362": "阿布丹核桃玛仁玫瑰味 228g", "50563403": "阿布丹核桃玛仁葡萄味 228g", "50563431": "阿布丹 核桃玛仁芝麻味 228g", "50585703": "阿布丹 核桃玛仁什锦装 380g", "50586156": "阿布丹熟鹰嘴豆500g", "50586215": "阿布丹多彩400g", "50586270": "阿布丹桑葚干400g", "50586340": "阿布丹小银杏400g", "50586392": "阿布丹罐装葡萄干400g", "50586424": "阿布丹奶油巴旦木300g", "50586499": "阿布丹无花果400g", "50586701": "阿布丹绿香妃400g", "50586782": "阿布丹枸杞400g", "50587040": "阿布丹罐装巴旦木仁400g", "50587550": "阿布丹 干果组合装A款礼盒1518g", "50587736": "阿布丹 干果组合装B款礼盒 1600g/盒", "50587815": "阿布丹 干果休闲组合装C款 2400g", "50587906": "阿布丹 干果组合装礼盒D款 1418g", "50992920": "阿布丹熟鹰嘴豆500g", "50993198": "阿布丹多彩400g", "50993329": "阿布丹桑葚干400g", "52000086": "阿布丹 干果组合装A款礼盒1518g", "52009617": "阿布丹和田大枣500g", "52009729": "阿布丹纸皮核桃500g", "52009815": "阿布丹带衣腰果400g", "52009870": "阿布丹开心果400g", "52009940": "阿布丹每日坚果400g", "52010020": "阿布丹半边梅400g", "52642876": "阿布丹蜂蜜280g", "67137504": "阿布丹 核桃玛仁原味 228g", "67137505": "阿布丹核桃玛仁葡萄味 228g", "67137506": "阿布丹 核桃玛仁芝麻味 228g", "67137507": "阿布丹核桃玛仁玫瑰味 228g", "67137508": "阿布丹 核桃玛仁什锦装 380g", "67578006": "阿布丹 核桃玛仁酥480g", "67578007": "阿布丹去皮红枣500g", //爱心北京 key：商品ID "84dfef0ec3824b7eb931517878ca8ebf": "阿布丹 干果组合装C款 2400g", "a4e39d312e90494f9802acaabffd79be": "阿布丹 干果组合装A款礼盒1518g", "a497841d8cf04d31a8111e91c495fc0b": "阿布丹蜂蜜280g", "2cad6f1225624c3699a395fceca6ce8e": "阿布丹半边梅400g", "83884e0b09e5472babeddb22f668d5c5": "阿布丹每日坚果400g", "9ca5c24d99ec40b5ac10bb73ec9f564a": "阿布丹开心果400g", "79dbd81cf5e94755a9753e3ed9201e59": "阿布丹带衣腰果400g", "d881765fb21a4226aa35a344a12537ff": "阿布丹和田大枣500g", "9ab6185e3dce4d8f80c6924865fa8e88": "阿布丹纸皮核桃500g", "40c96eb9eb67423395236dc6bf248e77": "阿布丹罐装巴旦木仁400g", "26a1179829344c2ca9d16708437c1668": "阿布丹枸杞400g", "da44e4e8506245888148d45f7511a1e7": "阿布丹绿香妃400g", "868de3dc2932465592e77f166f9eaaa7": "阿布丹无花果400g", "27c308eebbf4490a91d51405f363c5b9": "阿布丹奶油巴旦木300g", "77e3e7a0f30b4631a1be37a591b07820": "阿布丹罐装葡萄干400g", "3bfa18b4715345268fb2f609e4987870": "阿布丹小银杏400g", "dab637d527e44c4a9ab6b46261ab18e4": "阿布丹桑葚干400g", "49315d119fe84976abecad543a1134d0": "阿布丹多彩400g", "1f40c4035ebd4caea703ad1a850101ac": "阿布丹熟鹰嘴豆500g", "a2ecaba926d945529caa8df098374506": "阿布丹半边梅400g,阿布丹熟鹰嘴豆500g", "b274f0b61c5344619998db969ce7f9c3": "阿布丹多彩400g,阿布丹开心果400g,阿布丹枸杞400g,阿布丹小银杏400g,阿布丹和田大枣500g,阿布丹奶油巴旦木300g,阿布丹琥珀核桃仁400g,阿布丹蜂蜜280g", "26138f6a5e4e456d8b17e915731da363": "阿布丹多彩400g,阿布丹纸皮核桃500g,阿布丹每日坚果400g,阿布丹半边梅400g,阿布丹桑葚干400g,阿布丹带衣腰果400g", "08a5c268f10f45fc81cb13ea65ab925a": "阿布丹桑葚干400g,阿布丹熟鹰嘴豆500g,阿布丹半边梅400g,阿布丹和田大枣500g", "0fc5499bb8374003b54e33473b039c59": "阿布丹奶油巴旦木300g,阿布丹多彩400g", "1bd9ac3574de441989749e98edaf48a9": "阿布丹奶油巴旦木300g,阿布丹半边梅400g", "f582388d23c94aa38b3869a4a5772a1b": "阿布丹奶油巴旦木300g,阿布丹熟鹰嘴豆500g", "1e270ebc15b0486d8c2a008e40f23592": "阿布丹奶油巴旦木300g,阿布丹罐装和田红枣218g", "eeed7c88451b439fa1cd173f07b702e6": "阿布丹多彩400g,阿布丹半边梅400g", "e2f4416e1e9443cf8a56bc5ab5bbd869": "阿布丹多彩400g,阿布丹熟鹰嘴豆500g", "11ac67e7bab445edbaf618966b9e408c": "阿布丹多彩400g,阿布丹罐装和田红枣218g", "64946f5563b144768ed550c7f6f99c18": "阿布丹 核桃玛仁什锦装 380g", "53602780cd3840efa2b66031a71b3671": "阿布丹核桃玛仁玫瑰味 228g", "e3c7888e269141128b45b8554fdab852": "阿布丹 核桃玛仁芝麻味 228g", "1159cbfff4dd4a96be8dc1a78e01355e": "阿布丹核桃玛仁葡萄味 228g", "9ff45f2e286049ad8f7fd778d64c75d7": "阿布丹 核桃玛仁原味 228g", "9b012c34f1c84a85b76b1a59450d5580": "阿布丹去皮红枣500g", "8dcc4e2f3f234418befe8f30d6c48d85": "阿布丹 核桃玛仁酥480g", "64165eabfc37400e886b83248ed8995e": "(四罐装礼盒)阿布丹罐装巴旦木仁400g,阿布丹无花果400g,阿布丹带衣腰果400g,阿布丹开心果400g", //三峡e购 key：商品编码 "12437567": "阿布丹 核桃玛仁原味 228g", "12438423": "阿布丹核桃玛仁玫瑰味 228g", "12438878": "阿布丹核桃玛仁葡萄味 228g", "12438967": "阿布丹 核桃玛仁芝麻味 228g", "12467822": "阿布丹 核桃玛仁什锦装 380g", "12468012": "阿布丹熟鹰嘴豆500g", "12468129": "阿布丹多彩400g", "12468267": "阿布丹桑葚干400g", "12468344": "阿布丹小银杏400g", "12468439": "阿布丹罐装葡萄干400g", "12468672": "阿布丹奶油巴旦木300g", "12468793": "阿布丹无花果400g", "12468920": "阿布丹绿香妃400g", "12469106": "阿布丹枸杞400g", "12469214": "阿布丹罐装巴旦木仁400g", "12469215": "阿布丹纸皮核桃500g", "12469216": "阿布丹和田大枣500g", "12469241": "阿布丹带衣腰果400g", "12469242": "阿布丹开心果400g", "12469243": "阿布丹每日坚果400g", "12469244": "阿布丹半边梅400g", "12469319": "阿布丹 干果组合装A款礼盒1518g", "12469320": "阿布丹 干果组合装B款礼盒 1600g/盒", "12469321": "阿布丹 干果组合装C款 2400g", "12469322": "阿布丹 干果组合装礼盒D款 1418g", "14571183": "阿布丹奶油巴旦木300g,阿布丹多彩400g", "14573857": "阿布丹多彩400g,阿布丹熟鹰嘴豆500g", "14573978": "阿布丹多彩400g,阿布丹半边梅400g", "14574077": "阿布丹多彩400g,阿布丹罐装和田红枣218g", "14574155": "阿布丹奶油巴旦木300g,阿布丹熟鹰嘴豆500g", "14574197": "阿布丹奶油巴旦木300g,阿布丹半边梅400g", "14574275": "阿布丹奶油巴旦木300g,阿布丹罐装和田红枣218g", "17681076": "阿布丹每日坚果400g,阿布丹半边梅400g", "17681077": "阿布丹罐装葡萄干400g,阿布丹无花果400g", "17681078": "阿布丹桑葚干400g,阿布丹熟鹰嘴豆500g", "20314756": "阿布丹去皮红枣500g", "20312548": "阿布丹 核桃玛仁酥480g", //央企消费帮扶 "南航集团 新疆墨玉 阿布丹 葡萄干 400g": "阿布丹罐装葡萄干400g", "南航集团 新疆墨玉 阿布丹 每日坚果 400g": "阿布丹每日坚果400g", "南航集团 新疆墨玉 阿布丹 纸皮核桃 500g": "阿布丹纸皮核桃500g", "南航集团 新疆墨玉 阿布丹 和田大枣 500g": "阿布丹和田大枣500g", "南航集团 新疆墨玉 阿布丹 桑葚干 400g": "阿布丹桑葚干400g", "南航集团 新疆墨玉 阿布丹 巴旦木 300g": "阿布丹奶油巴旦木300g", "南航集团 和田墨玉 阿布丹 干果休闲组合装D款 1600g": "阿布丹 干果休闲组合装D款 1600g", "南航集团 新疆墨玉 阿布丹 枸杞 400g": "阿布丹枸杞400g", "南航集团 新疆墨玉 阿布丹 和田红枣 218g": "阿布丹罐装和田红枣218g", "南航集团 新疆墨玉 阿布丹 熟鹰嘴豆 500g": "阿布丹熟鹰嘴豆500g", "南航集团 新疆墨玉 阿布丹 无花果干 400g": "阿布丹无花果400g", "南航集团 新疆墨玉 阿布丹 巴旦木仁 400g": "阿布丹罐装巴旦木仁400g", "南航集团 新疆墨玉 阿布丹 绿香妃葡萄干 400g": "阿布丹绿香妃400g", "南航集团 新疆墨玉 阿布丹 干果休闲组合B款 2318g": "阿布丹 干果休闲组合B款 2318g", "南航集团 新疆墨玉 阿布丹 琥珀核桃仁 400g": "阿布丹琥珀核桃仁400g", "南航集团 新疆墨玉 阿布丹 干果组合装D款 1418g": "阿布丹 干果组合装礼盒D款 1418g", "南航集团 新疆墨玉 阿布丹 多彩葡萄干 400g": "阿布丹多彩400g", "南航集团 新疆墨玉 阿布丹 手剥小白杏核 400g": "阿布丹小银杏400g", "南航集团 新疆墨玉 阿布丹 每日坚果 400g": "阿布丹每日坚果400g", "南航集团 新疆墨玉 阿布丹 半边梅 400g": "阿布丹半边梅400g", "南航集团 新疆墨玉 阿布丹 桑葚干 400g": "阿布丹桑葚干400g", "南航集团 新疆墨玉 阿布丹 和田大枣 500g": "阿布丹和田大枣500g", "南航集团 新疆墨玉 阿布丹 干果休闲组合装C款 1980g": "阿布丹 干果休闲组合装C款 1980g", "南航集团 新疆墨玉 阿布丹 新疆黑蜂蜂蜜 280g": "阿布丹蜂蜜280g", "南航集团 和田墨玉 阿布丹 罐装带衣腰果 400g": "阿布丹带衣腰果400g", "南航集团 和田墨玉 阿布丹 罐装开心果 400g": "阿布丹开心果400g", "南航集团 和田墨玉  阿布丹 纸皮核桃 500g": "阿布丹纸皮核桃500g", "南航集团 新疆墨玉 阿布丹 干果组合装B款 1600g": "阿布丹 干果组合装B款礼盒 1600g/盒", "南航集团 新疆墨玉 阿布丹 干果组合装C款 2400g": "阿布丹 干果组合装C款 2400g", "南航集团 新疆墨玉 阿布丹 干果组合装D款 1418g": "阿布丹 干果组合装礼盒D款 1418g", "南航集团 新疆墨玉 阿布丹 核桃玛仁什锦装 380g": "阿布丹 核桃玛仁什锦装 380g", "南航集团 新疆墨玉 阿布丹 核桃玛仁玫瑰味 228g": "阿布丹核桃玛仁玫瑰味 228g", "南航集团 新疆墨玉 阿布丹 核桃玛仁葡萄味 228g": "阿布丹核桃玛仁葡萄味 228g", "南航集团 新疆墨玉 阿布丹 核桃玛仁芝麻味 228g": "阿布丹 核桃玛仁芝麻味 228g", "南航集团 新疆墨玉 阿布丹 核桃玛仁原味 228g": "阿布丹 核桃玛仁原味 228g", //小南直选 "阿布丹罐装熟鹰嘴豆500g": "阿布丹熟鹰嘴豆500g", "阿布丹罐装多彩葡萄干400g 400g ": "阿布丹多彩400g", "阿布丹罐装多彩葡萄干400g 400g": "阿布丹多彩400g", "阿布丹罐装桑葚干400g": "阿布丹桑葚干400g", "阿布丹罐装手剥小白杏核400g": "阿布丹小银杏400g", "阿布丹罐装葡萄干400g ": "阿布丹罐装葡萄干400g", "阿布丹罐装巴旦木300g": "阿布丹奶油巴旦木300g", "阿布丹罐装无花果干400g": "阿布丹无花果400g", "阿布丹罐装绿香妃葡萄干400g": "阿布丹绿香妃400g", "阿布丹罐装枸杞400g": "阿布丹枸杞400g", "阿布丹罐装琥珀核桃仁400g": "阿布丹琥珀核桃仁400g", "阿布丹罐装巴旦木仁400g": "阿布丹罐装巴旦木仁400g", "阿布丹 纸皮核桃 500g/袋": "阿布丹纸皮核桃500g", "阿布丹 和田大枣 500g/袋": "阿布丹和田大枣500g", "阿布丹 带衣腰果 400g/罐": "阿布丹带衣腰果400g", "阿布丹 开心果 400g/罐": "阿布丹开心果400g", "阿布丹 每日坚果 400g/罐": "阿布丹每日坚果400g", "阿布丹 半边梅 400g/罐": "阿布丹半边梅400g", "阿布丹干果新春组合装A款 2500g": "阿布丹每日坚果400g,阿布丹纸皮核桃500g,阿布丹桑葚干400g,阿布丹半边梅400g,阿布丹无花果400g,阿布丹绿香妃400g", "阿布丹干果新春组合装B款 2280g": "阿布丹蜂蜜280g,阿布丹和田大枣500g,阿布丹罐装葡萄干400g,阿布丹枸杞400g,阿布丹奶油巴旦木300g,阿布丹小银杏400g", "阿布丹干果新春组合装C款 2190g": "阿布丹蜂蜜280g,阿布丹熟鹰嘴豆500g,阿布丹罐装巴旦木仁400g,阿布丹带衣腰果400g,阿布丹琥珀核桃仁400g,阿布丹罐装和田红枣218g", "阿布丹干果组合装A款礼盒 1518g ": "阿布丹罐装和田红枣218g,阿布丹熟鹰嘴豆500g,阿布丹桑葚干400g,阿布丹罐装葡萄干400g", "阿布丹干果组合装B款礼盒 1600g ": "阿布丹桑葚干400g,阿布丹无花果400g,阿布丹绿香妃400g,阿布丹小银杏400g", "阿布丹干果组合装C款礼盒 2400g ": "阿布丹桑葚干400g,阿布丹熟鹰嘴豆500g,阿布丹无花果400g,阿布丹奶油巴旦木300g,阿布丹小银杏400g,阿布丹多彩400g", "阿布丹干果组合装D款礼盒 1418g ": "阿布丹罐装和田红枣218g,阿布丹熟鹰嘴豆500g,阿布丹多彩400g,阿布丹奶油巴旦木300g", "阿布丹干果休闲组合装A款2380g": "阿布丹蜂蜜280g,阿布丹纸皮核桃500g,阿布丹罐装葡萄干400g,阿布丹带衣腰果400g,阿布丹开心果400g,阿布丹每日坚果400g", "阿布丹干果休闲组合装B款2318g 2318g ": "阿布丹熟鹰嘴豆500g,阿布丹小银杏400g,阿布丹罐装和田红枣218g,阿布丹无花果400g,阿布丹琥珀核桃仁400g,阿布丹罐装葡萄干400g", "阿布丹干果休闲组合装E款3180g": "阿布丹和田大枣500g,阿布丹蜂蜜280g,阿布丹带衣腰果400g,阿布丹每日坚果400g,阿布丹半边梅400g,阿布丹开心果400g,阿布丹罐装巴旦木仁400g,阿布丹绿香妃400g", "阿布丹干果组合装礼盒H款1700g 1700g ": "阿布丹半边梅400g,阿布丹琥珀核桃仁400g,阿布丹多彩400g,阿布丹熟鹰嘴豆500g", "阿布丹坚果零食新春优惠装A款 1000g ": "阿布丹纸皮核桃500g,阿布丹和田大枣500g", "阿布丹坚果零食新春优惠装B款 900g ": "阿布丹和田大枣500g,阿布丹多彩400g", "阿布丹坚果零食新春优惠装C款 800g ": "阿布丹每日坚果400g,阿布丹小银杏400g", "阿布丹坚果零食新春优惠装D款 800g ": "阿布丹无花果400g,阿布丹琥珀核桃仁400g", "阿布丹坚果零食新春优惠装E款 800g ": "阿布丹带衣腰果400g,阿布丹桑葚干400g", "阿布丹坚果零食新春优惠装F款 800g ": "阿布丹罐装葡萄干400g,阿布丹罐装巴旦木仁400g", "阿布丹干果新春组合装A款 2500g ": "阿布丹每日坚果400g,阿布丹纸皮核桃500g,阿布丹桑葚干400g,阿布丹半边梅400g,阿布丹无花果400g,阿布丹绿香妃400g", "阿布丹干果新春组合装B款 2280g ": "阿布丹蜂蜜280g,阿布丹和田大枣500g,阿布丹罐装葡萄干400g,阿布丹枸杞400g,阿布丹奶油巴旦木300g,阿布丹小银杏400g", "阿布丹干果新春组合装C款 2190g ": "阿布丹蜂蜜280g,阿布丹熟鹰嘴豆500g,阿布丹罐装巴旦木仁400g,阿布丹带衣腰果400g,阿布丹琥珀核桃仁400g,阿布丹罐装和田红枣218g", "阿布丹干果组合装A款礼盒 1518g": "阿布丹罐装和田红枣218g,阿布丹熟鹰嘴豆500g,阿布丹桑葚干400g,阿布丹罐装葡萄干400g", "阿布丹干果组合装B款礼盒 1600g": "阿布丹桑葚干400g,阿布丹无花果400g,阿布丹绿香妃400g,阿布丹小银杏400g", "阿布丹干果组合装C款礼盒 2400g": "阿布丹桑葚干400g,阿布丹熟鹰嘴豆500g,阿布丹无花果400g,阿布丹奶油巴旦木300g,阿布丹小银杏400g,阿布丹多彩400g", "阿布丹干果组合装D款礼盒 1418g": "阿布丹罐装和田红枣218g,阿布丹熟鹰嘴豆500g,阿布丹多彩400g,阿布丹奶油巴旦木300g", "阿布丹干果休闲组合装A款2380g ": "阿布丹蜂蜜280g,阿布丹纸皮核桃500g,阿布丹罐装葡萄干400g,阿布丹带衣腰果400g,阿布丹开心果400g,阿布丹每日坚果400g", "阿布丹干果休闲组合装B款2318g 2318g": "阿布丹熟鹰嘴豆500g,阿布丹小银杏400g,阿布丹罐装和田红枣218g,阿布丹无花果400g,阿布丹琥珀核桃仁400g,阿布丹罐装葡萄干400g", "阿布丹干果休闲组合装E款3180g ": "阿布丹和田大枣500g,阿布丹蜂蜜280g,阿布丹带衣腰果400g,阿布丹每日坚果400g,阿布丹半边梅400g,阿布丹开心果400g,阿布丹罐装巴旦木仁400g,阿布丹绿香妃400g", "阿布丹干果组合装礼盒H款1700g 1700g": "阿布丹半边梅400g,阿布丹琥珀核桃仁400g,阿布丹多彩400g,阿布丹熟鹰嘴豆500g", "阿布丹坚果零食新春优惠装A款 1000g": "阿布丹纸皮核桃500g,阿布丹和田大枣500g", "阿布丹坚果零食新春优惠装B款 900g": "阿布丹和田大枣500g,阿布丹多彩400g", "阿布丹坚果零食新春优惠装C款 800g": "阿布丹每日坚果400g,阿布丹小银杏400g", "阿布丹坚果零食新春优惠装D款 800g": "阿布丹无花果400g,阿布丹琥珀核桃仁400g", "阿布丹坚果零食新春优惠装E款 800g": "阿布丹带衣腰果400g,阿布丹桑葚干400g", "阿布丹坚果零食新春优惠装F款 800g": "阿布丹罐装葡萄干400g,阿布丹罐装巴旦木仁400g", "【买一赠一】阿布丹罐装多彩葡萄干400g赠罐装红枣218g 618g ": "阿布丹多彩400g,阿布丹罐装和田红枣218g", "【买一赠一】阿布丹罐装多彩葡萄干400g赠罐装熟鹰嘴豆500g 29.9 ": "阿布丹多彩400g,阿布丹熟鹰嘴豆500g", "【买一赠一】阿布丹罐装多彩葡萄干400g赠半边梅400g 800g ": "阿布丹多彩400g,阿布丹半边梅400g", "【买一赠一】阿布丹罐装巴旦木300g赠罐装红枣218g 518g ": "阿布丹奶油巴旦木300g,阿布丹罐装和田红枣218g", "【买一赠一】阿布丹罐装巴旦木300g赠罐装熟鹰嘴豆500g 800g ": "阿布丹奶油巴旦木300g,阿布丹熟鹰嘴豆500g", "【买一赠一】阿布丹罐装巴旦木300g赠半边梅400g 700g ": "阿布丹奶油巴旦木300g,阿布丹半边梅400g", "【优惠套餐】阿布丹罐装多彩葡萄干400g罐装巴旦木300g优惠组合 700g ": "阿布丹多彩400g,阿布丹奶油巴旦木300g", "阿布丹 核桃玛仁酥 480g/罐": "阿布丹 核桃玛仁酥480g", "阿布丹 新疆去皮无核枣 500g/罐": "阿布丹去皮红枣500g", //粤工惠购 ID=>name "12580": "阿布丹枸杞400g", "12572": "阿布丹多彩400g", "12595": "阿布丹 干果组合装B款礼盒 1600g/盒", "12601": "阿布丹开心果400g", "12602": "阿布丹每日坚果400g", "12600": "阿布丹带衣腰果400g", "12599": "阿布丹和田大枣500g", "12597": "阿布丹 干果组合装礼盒D款 1418g", "12566": "阿布丹 核桃玛仁什锦装 380g", "12570": "阿布丹熟鹰嘴豆500g", "12574": "阿布丹桑葚干400g", "12575": "阿布丹小银杏400g", "12581": "阿布丹罐装巴旦木仁400g", "12603": "阿布丹半边梅400g", "12557": "阿布丹核桃玛仁芝麻味 228g", "12576": "阿布丹罐装葡萄干400g", "12577": "阿布丹奶油巴旦木300g", "12584": "阿布丹 干果组合装A款礼盒1518g", "12596": "阿布丹 干果组合装C款 2400g", "12579": "阿布丹绿香妃400g", "12554": "阿布丹 核桃玛仁葡萄味 228g", "12556": "阿布丹 核桃玛仁原味 228g", "12565": "阿布丹 核桃玛仁玫瑰味 228g", "12578": "阿布丹无花果400g", "12598": "阿布丹纸皮核桃500g", "阿布丹 枸杞 400g/罐": "阿布丹枸杞400g", "阿布丹 罐装多彩葡萄干 400g": "阿布丹多彩400g", "阿布丹 干果组合装礼盒B款 1.6kg/盒": "阿布丹 干果组合装B款礼盒 1600g/盒", "阿布丹 开心果 400g/罐": "阿布丹开心果400g", "阿布丹 每日坚果 400g/罐": "阿布丹每日坚果400g", "阿布丹 带衣腰果 400g/罐": "阿布丹带衣腰果400g", "阿布丹 和田大枣 500g/袋": "阿布丹和田大枣500g", "阿布丹 干果组合装礼盒D款 1.418kg/盒": "阿布丹 干果组合装礼盒D款 1418g", "阿布丹 核桃玛仁什锦装 380g/袋": "阿布丹 核桃玛仁什锦装 380g", "阿布丹 罐装熟鹰嘴豆 500g/罐": "阿布丹熟鹰嘴豆500g", "阿布丹 罐装桑葚干 400g/罐": "阿布丹桑葚干400g", "阿布丹 小白杏核 400g/罐": "阿布丹小银杏400g", "阿布丹 巴旦木仁 400g/罐": "阿布丹罐装巴旦木仁400g", "阿布丹 半边梅  400g/罐": "阿布丹半边梅400g", "阿布丹 核桃玛仁芝麻味 228g": "阿布丹核桃玛仁芝麻味 228g", "阿布丹 罐装葡萄干 400g": "阿布丹罐装葡萄干400g", "阿布丹 罐装巴旦木 300g": "阿布丹奶油巴旦木300g", "阿布丹 干果组合装礼盒A款 1518g": "阿布丹 干果组合装A款礼盒1518g", "阿布丹 干果组合装礼盒C款 2400g": "阿布丹 干果组合装C款 2400g", "阿布丹 绿香妃葡萄干 400g/罐": "阿布丹绿香妃400g", "阿布丹 核桃玛仁葡萄味 228g": "阿布丹 核桃玛仁葡萄味 228g", "阿布丹 核桃玛仁原味 228g": "阿布丹 核桃玛仁原味 228g", "阿布丹 核桃玛仁玫瑰味 228g": "阿布丹 核桃玛仁玫瑰味 228g", "阿布丹 无花果干 400g/罐": "阿布丹无花果400g", "阿布丹 纸皮核桃 500g/袋": "阿布丹纸皮核桃500g", //茶觉文化-中信 "【新疆墨玉】阿布丹 核桃玛仁原味228g": "阿布丹 核桃玛仁原味 228g", "【新疆墨玉】阿布丹 核桃玛仁葡萄味228g": "阿布丹核桃玛仁葡萄味 228g", "【新疆墨玉】阿布丹 核桃玛仁芝麻味228g": "阿布丹 核桃玛仁芝麻味 228g", "【新疆墨玉】阿布丹 核桃玛仁玫瑰味228g": "阿布丹核桃玛仁玫瑰味 228g", "【新疆墨玉】阿布丹 核桃玛仁什锦装380g": "阿布丹 核桃玛仁什锦装 380g", "【新疆墨玉】阿布丹 核桃玛仁什锦装500g": "阿布丹 核桃玛仁什锦装500g", "【新疆墨玉】阿布丹 熟鹰嘴豆500g/罐": "阿布丹熟鹰嘴豆500g", "【新疆墨玉】阿布丹 多彩葡萄干400g/罐": "阿布丹多彩400g", "【新疆墨玉】阿布丹 桑葚干400g/罐": "阿布丹桑葚干400g", "【新疆墨玉】阿布丹 手剥小白杏核400g/罐": "阿布丹小银杏400g", "【新疆墨玉】阿布丹 葡萄干400g/罐": "阿布丹罐装葡萄干400g", "【新疆墨玉】阿布丹 巴旦木300g/罐": "阿布丹奶油巴旦木300g", "【新疆墨玉】阿布丹 无花果干400g/罐": "阿布丹无花果400g", "【新疆墨玉】阿布丹 绿香妃葡萄干400g/罐": "阿布丹绿香妃400g", "【新疆墨玉】阿布丹 巴旦木仁400g/罐": "阿布丹罐装巴旦木仁400g", "【新疆墨玉】阿布丹 枸杞400g/罐": "阿布丹枸杞400g", "【新疆墨玉】阿布丹 纸皮核桃500g/袋": "阿布丹纸皮核桃500g", "【新疆墨玉】阿布丹 和田大枣500g/袋": "阿布丹和田大枣500g", "【新疆墨玉】阿布丹 带衣腰果400g/罐": "阿布丹带衣腰果400g", "【新疆墨玉】阿布丹 开心果400g/罐": "阿布丹开心果400g", "【新疆墨玉】阿布丹 每日坚果400g/罐": "阿布丹每日坚果400g", "【新疆墨玉】阿布丹 半边梅400g/罐": "阿布丹半边梅400g", "【新疆墨玉】阿布丹 琥珀核桃仁400g/罐": "阿布丹琥珀核桃仁400g", "【新疆墨玉】阿布丹 新疆黑蜂蜂蜜280g/罐": "阿布丹蜂蜜280g", "【新疆墨玉】阿布丹 干果组合装礼盒A款1518g": "阿布丹罐装和田红枣218g,阿布丹熟鹰嘴豆500g,阿布丹桑葚干400g,阿布丹罐装葡萄干400g", "【新疆墨玉】阿布丹 干果组合装礼盒B款1600g": "阿布丹桑葚干400g,阿布丹无花果400g,阿布丹绿香妃400g,阿布丹小银杏400g", "【新疆墨玉】阿布丹 干果组合装礼盒C款2400g": "阿布丹桑葚干400g,阿布丹熟鹰嘴豆500g,阿布丹无花果400g,阿布丹奶油巴旦木300g,阿布丹小银杏400g,阿布丹多彩400g", "【新疆墨玉】阿布丹 干果组合装礼盒D款1418g": "阿布丹罐装和田红枣218g,阿布丹熟鹰嘴豆500g,阿布丹多彩400g,阿布丹奶油巴旦木300g", "【新疆墨玉】阿布丹 干果组合装礼盒F款1518g": "阿布丹罐装和田红枣218g,阿布丹熟鹰嘴豆500g,阿布丹多彩400g,阿布丹桑葚干400g", "【新疆墨玉】阿布丹 干果组合装礼盒G款2056g": "阿布丹熟鹰嘴豆500g,阿布丹多彩400g,阿布丹奶油巴旦木300g,阿布丹绿香妃400g,阿布丹 核桃玛仁原味 228g*2", "【新疆墨玉】阿布丹 干果组合装礼盒H款1700g": "阿布丹熟鹰嘴豆500g,阿布丹多彩400g,阿布丹琥珀核桃仁400g,阿布丹半边梅400g", "【新疆墨玉】阿布丹 干果组合装礼盒I款1700g": "阿布丹桑葚干400g,阿布丹枸杞400g,阿布丹每日坚果400g,阿布丹和田大枣500g", "【新疆墨玉】阿布丹 干果休闲组合B款2318g": "阿布丹熟鹰嘴豆500g,阿布丹小银杏400g,阿布丹罐装和田红枣218g,阿布丹无花果400g,阿布丹琥珀核桃仁400g,阿布丹罐装葡萄干400g", "【新疆墨玉】阿布丹 干果休闲组合D款1600g": "阿布丹熟鹰嘴豆500g,阿布丹多彩400g,阿布丹奶油巴旦木300g,阿布丹带衣腰果400g", "【新疆墨玉】阿布丹 干果休闲组合装E款3180g": "阿布丹带衣腰果400g,阿布丹开心果400g,阿布丹每日坚果400g,阿布丹半边梅400g,阿布丹绿香妃400g,阿布丹罐装巴旦木仁400g,阿布丹和田大枣500g,阿布丹蜂蜜280g", //好物购 "零食礼包四": "阿布丹核桃玛仁原味 228g,阿布丹去皮红枣500g,阿布丹带衣腰果400g", "零食礼包二": "阿布丹核桃玛仁什锦装 380g,阿布丹无花果400g,阿布丹带衣腰果400g,阿布丹去皮红枣500g,阿布丹半边梅400g", "零食礼包一": "阿布丹核桃玛仁什锦装 380g,阿布丹熟鹰嘴豆500g,阿布丹多彩400g,阿布丹桑葚干400g,阿布丹去皮红枣500g,阿布丹琥珀核桃仁400g", "零食礼包九": "阿布丹带衣腰果400g,阿布丹去皮红枣500g,阿布丹蜂蜜280g,阿布丹 核桃玛仁酥480g,阿布丹琥珀核桃仁400g", "零食礼包八": "阿布丹去皮红枣500g,阿布丹核桃玛仁原味 228g,阿布丹奶油巴旦木300g", "零食礼包五": "阿布丹核桃玛仁玫瑰味 228g,阿布丹琥珀核桃仁400g,阿布丹多彩400g", "阿布丹 核桃玛仁酥 480g/罐": "阿布丹 核桃玛仁酥480g", "阿布丹新疆去皮无核枣 500g/罐": "阿布丹去皮红枣500g", "库尔勒香梨 5kg/箱": "库尔勒香梨 5kg/箱", "新疆阿克苏冰糖心苹果 10kg/箱": "新疆阿克苏冰糖心苹果 10kg/箱", "阿布丹 干果组合礼盒A款4罐装1518g": "阿布丹 干果组合装A款礼盒1518g", "阿布丹 干果组合装礼盒C款6罐装2400g": "阿布丹干果组合装C款 2400g", "阿布丹 核桃玛仁原味 228g/袋": "阿布丹核桃玛仁原味 228g", "阿布丹 和田大枣 500g/袋": "阿布丹和田大枣500g", "阿布丹 新疆黑蜂蜂蜜 280g/瓶": "阿布丹蜂蜜280g", "阿布丹 奶油味巴旦木300g/罐": "阿布丹奶油巴旦木300g", "阿布丹 半边梅400g/罐": "阿布丹半边梅400g", "阿布丹 带衣腰果 400g/罐": "阿布丹带衣腰果400g", "阿布丹葡萄干400g/罐": "阿布丹罐装葡萄干400g", "阿布丹 多彩葡萄干 400g/罐": "阿布丹多彩400g", "阿布丹 手剥小白杏核 400g/罐": "阿布丹小银杏400g", "阿布丹 开心果400g/罐": "阿布丹开心果400g", "阿布丹 绿香妃葡萄干 400g/罐": "阿布丹绿香妃400g", "阿布丹 每日坚果 400g/罐": "阿布丹每日坚果400g", "阿布丹 桑葚干400g/罐": "阿布丹桑葚干400g", "阿布丹 无花果干 400g/罐": "阿布丹无花果400g", "阿布丹 新疆鹰嘴豆（熟）500g/罐": "阿布丹熟鹰嘴豆500g", "阿布丹 纸皮核桃 500g/袋": "阿布丹纸皮核桃500g", "阿布丹 芝麻琥珀核桃仁400g/罐": "阿布丹琥珀核桃仁400g", "阿布丹 核桃玛仁玫瑰味 228g/袋": "阿布丹核桃玛仁玫瑰味 228g", "阿布丹 核桃玛仁葡萄味 228g/袋": "阿布丹核桃玛仁葡萄味 228g", "阿布丹 核桃玛仁芝麻味 228g/袋": "阿布丹核桃玛仁芝麻味 228g", "阿布丹 核桃玛仁什锦装 38Og/袋": "阿布丹核桃玛仁什锦装 380g", "阿布丹 枸杞 400g/罐": "阿布丹枸杞400g", "阿布丹 巴旦木仁 300g/罐": "阿布丹罐装巴旦木仁400g", }; //替换商品名称 let replaceText = (data) => { // 在这里可以使用data数组进行数据处理或显示 console.log(data); let newArr = []; //输出到原始数据框 $("#beforeObj").val(data.join("\n")); for (let i = 0; i < data.length; i++) { let oldStr = data[i]; if (defaultConfig[oldStr]) { newArr.push(defaultConfig[oldStr]); } else { newArr.push(oldStr); } }; console.log(newArr); $("#resultObj").val(newArr.join("\n")); }; function clipText(data) { // 在这里可以使用data数组进行数据处理或显示 console.log(data); let newJson = {}; for (let i = 0; i < data.length; i++) { //csv行数据 let obj = data[i]; let num = obj[0] + "A" + i; newJson[num] = obj[1]; } //输出到原始数据框 let oldStr = JSON.stringify(data) .replaceAll("[", "") .replaceAll('"', "") .replaceAll("],", "\n") .replaceAll(",", "->") .replaceAll("]]", ""); $("#beforeObj").val(oldStr); //转换为字符串输出到文本域 let newStr = JSON.stringify(newJson) .replaceAll("{", "") .replaceAll("}", "") .replaceAll('"', "") .replaceAll(",", "\n"); $("#resultObj").val(newStr); }; function clipOrder(data) { // console.log(data); let arrayData = []; for (let i = 0; i < data.length; i++) { //csv行数据 let obj = data[i]; let num = obj.length - 1; let col = obj[num].split(","); for (let i = 0; i < col.length; i++) { let numData = obj[0] + "A" + arrayData.length; arrayData.push(numData + "," + col[i] + "," + obj); }; }; console.log(arrayData); //输出到原始数据框 let oldStr = JSON.stringify(data) .replaceAll("[", "") .replaceAll('"', "") .replaceAll("],", "\n") .replaceAll(",", ",") .replaceAll("]]", ""); $("#beforeObj").val(oldStr); //转换为字符串输出到文本域 let newStr = arrayData.join(";") .replaceAll(";", "\n"); $("#resultObj").val(newStr); }; let tableCsvHeader  =  ["订单编号","客户网名","收货人","电话","州省","区市","区县","地址","客服备注","客户备注","编号","品名"," "," ","数量","合计"]; let ptConfig = {"hwg":[0,6,7,8,11,12,12]}; //按照平台配置信息矩阵返回对应的数组 let creatTab = (arr,obj) =>{ let tableCsv  =  ["订单编号","客户网名","收货人","电话","州省","区市","区县","地址","客服备注","客户备注","编号","品名"," "," ","数量","合计"]; for (let i = 1; i < arr.length; i++) { let j = i; let tabArr = ptConfig[obj]; if (arr[j] !== undefined && arr[j].length > 0) { let row = arr[j]; let tableRowStr = row[0]+"A"+i+"|"+"阿布丹|"+row[6]+"|"+row[7]+"|"+"  |"+"  |"+"  |"+row[8]+"|"+obj+"|  |"+defaultConfig[row[11]]+"|"+"  |"+"  |"+"  |"+row[12]+"|"+row[12]; tableCsv.push(tableRowStr.split("|")); }; }; return tableCsv; }; //好物购制单 let creatCsvTab  =  (arr)=>{ let CsvTab  =  [["订单编号","客户网名","收货人","电话","州省","区市","区县","地址","客服备注","客户备注","编号","品名"," "," ","数量","合计"]]; for (let i = 0; i < arr.length; i++) { let obj = arr[i][10]; if (obj !== undefined && obj.length > 0) { let spArr  =  obj.split(","); for (let j = 0; j < spArr.length; j++) { let rowStr = arr[i][0]+j+","+arr[i][1]+","+arr[i][2]+","+arr[i][3]+","+arr[i][4]+","+arr[i][5]+","+arr[i][6]+","+arr[i][7]+","+arr[i][8]+","+arr[i][9]+","+spArr[j]+","+arr[i][11]+","+arr[i][12]+","+arr[i][13]+","+arr[i][14]+","+arr[i][15]; CsvTab.push(rowStr.split(",")); } } }; downloadCsv(CsvTab); }; function clipHwg(data) { // console.log(data); let arrayData = []; for (let i = 0; i < data.length-1; i++) { //csv行数据 let objStr = data[i][4]; let obj = objStr.replaceAll("[", "").replaceAll("]", "").split(', '); for (let j = 0; j < obj.length; j++) { let dataArray = obj[j]; let name = dataArray.slice(0, dataArray.indexOf("*")); let num = dataArray.slice(dataArray.indexOf("*") + 1); let str = data[i].join("|")+"|"+data[i][0]+"A"+j+"|"+name+"|"+num; arrayData.push(str); } }; let newArray = []; let tilArray  = []; tilArray.push((data[0]+",新订单编号,商品名称,数量").split(",")); newArray.push(tilArray); let datalist = arrayData.shift(); for (let i = 0; i < arrayData.length; i++) { let arr = []; arr.push(arrayData[i].replaceAll(",", "、").replaceAll("\n", " ").split("|")); newArray.push(arr); }; downloadCsv(newArray); //输出到原始数据框 let oldStr = JSON.stringify(data) .replaceAll("[", "") .replaceAll('"', "") .replaceAll("],", "\n") .replaceAll(",", ",") .replaceAll("]]", ""); $("#beforeObj").val(oldStr); let newStr = tilArray.join(",")+"\n"+arrayData.join("#") .replaceAll("#", "\n") .replaceAll("]]", ""); $("#resultObj").val(newStr); }; let changeE = ()=>{ // 目标时间：2025年1月15日20:00:00 let targetTime = new Date('2025-01-15T20:00:00').getTime(); // 获取当前时间的时间戳 let currentTime = new Date().getTime(); // 计算时间差（毫秒） let timeDifference = targetTime - currentTime; if (timeDifference<=0) { $("#splitCsv").unbind("click").css({"background":"#999","color":"#fff"}).text("拆分回传快递单号（功能已失效）") $("#replaceText").unbind("click").css({"background":"#999","color":"#fff"}).text("替换商品名称（功能已失效）") $("#clipHwg").unbind("click").css({"background":"#999","color":"#fff"}).text("拆单-好物购（功能已失效）") $("#hwgCreatCsv").unbind("click").css({"background":"#999","color":"#fff"}).text("制单-好物购（功能已失效）") $(".uploadBox").unbind("click").css({"background":"#999","color":"#fff"}).text("点击上传csv文件（功能已失效）") } } setTimeout(() => { changeE(); }, 300); }); </script> </body> </html>
